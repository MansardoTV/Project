version: '3.8'

services:
  restaurant-parser:
    build: .
    container_name: restaurant-parser
    volumes:
      - ./output:/app/output
    command: >
      sh -c "
        echo 'üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤...'
        python parser_docker.py
        
        echo '‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω!'
        echo 'üìÇ JSON —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ /app/output/'
        
        echo 'üéØ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞!'
        echo 'üåê –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:5000'
        
        # –û—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–∫—Ç–∏–≤–Ω—ã–º
        tail -f /dev/null
      "

  web-interface:
    build: .
    container_name: hive-web
    ports:
      - "5000:5000"
    volumes:
      - ./output:/app/output
    depends_on:
      - restaurant-parser
    command: >
      sh -c "
        echo '‚è≥ –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–∞—Ä—Å–µ—Ä–∞...'
        sleep 30
        
        echo 'üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏...'
        pip install flask matplotlib --quiet
        
        echo 'üåê –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä...'
        echo '   –û—Ç–∫—Ä–æ–π: http://localhost:5000'
        python web_hive.py
      "